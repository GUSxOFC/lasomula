<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Penyimpanan Akun Telegram</title>
  <style>
    body { font-family: Arial; background:#f2f2f2; padding:20px; }
    .box { background:white; padding:20px; border-radius:10px; max-width:600px; margin:auto; }
    input { width:100%; padding:10px; margin:10px 0; border-radius:6px; border:1px solid #ccc; }
    button { padding:10px 15px; border:none; border-radius:6px; cursor:pointer; }
    .send { background:#1976D2; color:white; }
    .save { background:#00bfa6; color:white; }
    .logout { background:#d32f2f; color:white; margin-top:10px; }
    .item { background:#fff; padding:10px; margin:10px 0; border-radius:8px; border:1px solid #eee; }
  </style>
</head>
<body>

<div class="box">
  <h2>Penyimpanan Akun Telegram</h2>

  <label>Masukan nomor telegram anda</label>
  <input id="nomor" type="text" placeholder="+62XXXX">

  <label>Masukan code yang udh di kirimkan</label>
  <input id="kode" type="text" placeholder="Kode OTP">

  <button class="send" onclick="kirim()">Kirim code</button>
  <button class="save" onclick="verif()">Verifikasi & Simpan</button>

  <h3>Daftar akun (max 100)</h3>
  <div id="list"></div>

</div>

<script>
let akun = JSON.parse(localStorage.getItem("akunTG") || "[]");

function render() {
  let html = "";
  akun.forEach(a => {
    html += `
      <div class="item">
        <b>Nomor:</b> ${a.nomor}<br>
        <b>Status:</b> Login tersimpan
      </div>
    `;
  });
  document.getElementById("list").innerHTML = html;
}

async function kirim() {
  const nomor = document.getElementById("nomor").value.trim();
  if (!nomor) return alert("Masukkan nomor!");

  const res = await fetch("/kirimOTP?nomor=" + nomor);
  const data = await res.json();

  alert(data.msg);
}

async function verif() {
  const nomor = document.getElementById("nomor").value.trim();
  const kode = document.getElementById("kode").value.trim();

  if (!nomor || !kode) return alert("Isi nomor & kode!");

  const res = await fetch("/verifikasi", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({ nomor, kode })
  });

  const data = await res.json();

  if (!data.ok) return alert(data.msg);

  akun.push({ nomor });
  localStorage.setItem("akunTG", JSON.stringify(akun));

  render();
  alert("Akun berhasil disimpan!");
}

render();
</script>

</body>
</html>
